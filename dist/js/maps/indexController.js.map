{"version":3,"sources":["indexController.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","api","Api","instance","TypeError","_classCallCheck","this","apiURI","error","console","log","response","ok","statusText","json","endpoint","URI","fetch","then","validateResponse","readResponseAsJSON","catch","logError","default","2","Component","setState","bind","newState","assign","state","3","obj","_extends","arguments","source","hasOwnProperty","_app","_api","_api2","__esModule","Index","_Component","_this","self","ReferenceError","_possibleConstructorReturn","__proto__","getPrototypeOf","_showCachedCurrencies","openDatabase","currencies","indexDB","window","indexedDB","mozIndexedDB","webkitIndexedDB","msIndexedDB","dbName","subClass","superClass","create","constructor","setPrototypeOf","_inherits","_this2","navigator","serviceWorker","Promise","resolve","alert","dbPromise","open","upgradeDB","upgradeDb","objectStoreNames","contains","createObjectStore","keyPath","objectStore","createIndex","db","tx","transaction","store","item","id","name","price","description","created","Date","getTime","add","complete","put","_this3","result","index","get","entries","results","map","val","onChange","onComplete","close","./../api","./../components/app","4","_idb","_idb2","_trackInstalling","worker","addEventListener","_updateReady","document","getElementById","className","postMessage","action","register","reg","scope","controller","waiting","installing","refreshing","location","reload","registerServiceWorker","./../idb"],"mappings":"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","file":"../indexController.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Api = function () {\n  function Api() {\n    _classCallCheck(this, Api);\n\n    this.apiURI = \"https://free.currencyconverterapi.com/api/v5\";\n  }\n\n  _createClass(Api, [{\n    key: \"logError\",\n    value: function logError(error) {\n      console.log(\"Looks like there was a problem: \\n\", error);\n    }\n  }, {\n    key: \"validateResponse\",\n    value: function validateResponse(response) {\n      if (!response.ok) {\n        throw Error(response.statusText);\n      }\n      return response;\n    }\n  }, {\n    key: \"readResponseAsJSON\",\n    value: function readResponseAsJSON(response) {\n      return response.json();\n    }\n  }, {\n    key: \"get\",\n    value: function get(endpoint) {\n      var URI = \"\" + this.apiURI + endpoint;\n      return fetch(URI).then(this.validateResponse).then(this.readResponseAsJSON).catch(this.logError);\n    }\n  }]);\n\n  return Api;\n}();\n\nvar api = new Api();\n\nexports.default = api;\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Component = exports.Component = function () {\n  function Component() {\n    _classCallCheck(this, Component);\n\n    this.setState = this.setState.bind(this);\n  }\n\n  _createClass(Component, [{\n    key: \"setState\",\n    value: function setState(newState) {\n      return Object.assign(this.state, newState);\n    }\n  }]);\n\n  return Component;\n}();\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _app = require(\"./../components/app\");\n\nvar _api = require(\"./../api\");\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Index = function (_Component) {\n  _inherits(Index, _Component);\n\n  function Index() {\n    _classCallCheck(this, Index);\n\n    var _this = _possibleConstructorReturn(this, (Index.__proto__ || Object.getPrototypeOf(Index)).call(this));\n\n    _this._showCachedCurrencies = function () {\n      console.log(\"[Service Worker] showing cached images\");\n      return _this.openDatabase();\n    };\n\n    _this.state = {\n      currencies: {}\n    };\n    _this.indexDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;\n    _this.dbName = \"CConverter\";\n    return _this;\n  }\n  // Create the schema\n\n\n  _createClass(Index, [{\n    key: \"openDatabase\",\n    value: function openDatabase() {\n      var _this2 = this;\n\n      // If the browser doesn't support service worker,\n      // we don't care about having a database\n      if (!navigator.serviceWorker) {\n        return Promise.resolve();\n      }\n      if (!this.indexDB) {\n        window.alert(\"Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.\");\n      }\n      var dbPromise = this.indexDB.open(this.dbName, 2, function (upgradeDB) {\n        if (!upgradeDb.objectStoreNames.contains(\"currency\")) {\n          upgradeDb.createObjectStore(\"currency\", { keyPath: \"id\" });\n        }\n        if (!upgradeDb.objectStoreNames.contains(\"countries\")) {\n          upgradeDb.createObjectStore(\"countries\", { keyPath: \"id\" });\n        }\n        objectStore.createIndex(\"currency\", \"countries\");\n      });\n      console.log(dbPromise);\n      dbPromise.then(function (db) {\n        var tx = db.transaction(_this2.dbName, \"readwrite\");\n        var store = tx.objectStore(_this2.store);\n        var item = {\n          id: 1,\n          name: \"sandwichs\",\n          price: 4.99,\n          description: \"A very tasty sandwich\",\n          created: new Date().getTime()\n        };\n        store.add(_extends({}, item));\n        return tx.complete;\n      }).then(function () {\n        console.log(\"added item to the store os!\");\n      });\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange() {\n      var currencies = _extends({}, this.state.currencies);\n      store.put(currencies);\n      console.log(currencies);\n    }\n  }, {\n    key: \"putCurrencies\",\n    value: function putCurrencies() {\n      var _this3 = this;\n\n      // Start a new transaction\n      var db = this.db.result;\n      var tx = db.transaction(this.dbName, \"readwrite\");\n      var store = tx.objectStore(this.dbName);\n      var index = store.index(\"currency\");\n      console.log(\"Adding currencies\");\n      // Add some data\n      _api2.default.get(\"/currencies\").then(function (response) {\n        Object.entries(result.results).map(function (val) {\n          _this3.setState({\n            currencies: _extends({}, val[1])\n          });\n          _this3.onChange();\n        });\n      });\n\n      // Query the data\n      // Close the db when the transaction is done\n      tx.onComplete = function () {\n        db.close();\n      };\n    }\n  }]);\n\n  return Index;\n}(_app.Component);\n\nexports.default = Index;\n\n},{\"./../api\":1,\"./../components/app\":2}],4:[function(require,module,exports){\n\"use strict\";\n\nvar _idb = require(\"./../idb\");\n\nvar _idb2 = _interopRequireDefault(_idb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction IndexController() {\n  var index = new _idb2.default();\n  registerServiceWorker();\n\n  index._showCachedCurrencies();\n}\nvar registerServiceWorker = function registerServiceWorker() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.register(\"./../sw.js\").then(function (reg) {\n      console.log(\"Service Worker Registered on scope \" + reg.scope);\n      if (!navigator.serviceWorker.controller) {\n        return;\n      }\n\n      if (reg.waiting) {\n        _updateReady(reg.waiting);\n        return;\n      }\n\n      if (reg.installing) {\n        _trackInstalling(reg.installing);\n        return;\n      }\n\n      reg.addEventListener(\"updatefound\", function () {\n        _trackInstalling(reg.installing);\n      });\n    });\n\n    var refreshing = void 0;\n    navigator.serviceWorker.addEventListener(\"controllerchange\", function () {\n      if (refreshing) return;\n      window.location.reload();\n      refreshing = true;\n    });\n  } else {\n    console.log(\"Service Worker is not supported by browser.\");\n  }\n};\n\nvar _trackInstalling = function _trackInstalling(worker) {\n  worker.addEventListener(\"statechange\", function () {\n    if (worker.state == \"installed\") {\n      _updateReady(worker);\n    }\n  });\n};\n\nvar _updateReady = function _updateReady(worker) {\n  var newWorker = void 0;\n  var notification = document.getElementById(\"notification\");\n  notification.className = \"show\";\n  // The click event on the pop up notification\n  document.getElementById(\"reload\").addEventListener(\"click\", function () {\n    worker.postMessage({ action: \"skipWaiting\" });\n  });\n};\n\nIndexController();\n\n},{\"./../idb\":3}]},{},[4])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvYXBpL2luZGV4LmpzIiwic3JjL2pzL2NvbXBvbmVudHMvYXBwLmpzIiwic3JjL2pzL2lkYi9pbmRleC5qcyIsInNyYy9qcy9tYWluL2luZGV4Q29udHJvbGxlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7SUNBTSxHO0FBQ0osaUJBQWM7QUFBQTs7QUFDWixTQUFLLE1BQUwsR0FBYyw4Q0FBZDtBQUNEOzs7OzZCQUVRLEssRUFBTztBQUNkLGNBQVEsR0FBUixDQUFZLG9DQUFaLEVBQWtELEtBQWxEO0FBQ0Q7OztxQ0FFZ0IsUSxFQUFVO0FBQ3pCLFVBQUksQ0FBQyxTQUFTLEVBQWQsRUFBa0I7QUFDaEIsY0FBTSxNQUFNLFNBQVMsVUFBZixDQUFOO0FBQ0Q7QUFDRCxhQUFPLFFBQVA7QUFDRDs7O3VDQUVrQixRLEVBQVU7QUFDM0IsYUFBTyxTQUFTLElBQVQsRUFBUDtBQUNEOzs7d0JBRUcsUSxFQUFVO0FBQ1osVUFBTSxXQUFTLEtBQUssTUFBZCxHQUF1QixRQUE3QjtBQUNBLGFBQU8sTUFBTSxHQUFOLEVBQ0osSUFESSxDQUNDLEtBQUssZ0JBRE4sRUFFSixJQUZJLENBRUMsS0FBSyxrQkFGTixFQUdKLEtBSEksQ0FHRSxLQUFLLFFBSFAsQ0FBUDtBQUlEOzs7Ozs7QUFHSCxJQUFNLE1BQU0sSUFBSSxHQUFKLEVBQVo7O2tCQUVlLEc7Ozs7Ozs7Ozs7Ozs7SUMvQkYsUyxXQUFBLFM7QUFDWCx1QkFBYztBQUFBOztBQUNaLFNBQUssUUFBTCxHQUFnQixLQUFLLFFBQUwsQ0FBYyxJQUFkLENBQW1CLElBQW5CLENBQWhCO0FBQ0Q7Ozs7NkJBRVEsUSxFQUFVO0FBQ2pCLGFBQU8sT0FBTyxNQUFQLENBQWMsS0FBSyxLQUFuQixFQUEwQixRQUExQixDQUFQO0FBQ0Q7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDUEg7O0FBQ0E7Ozs7Ozs7Ozs7OztJQUNx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LENBTkQ7O0FBUUEsSUFBTSxlQUFlLFNBQWYsWUFBZSxTQUFVO0FBQzdCLE1BQUksa0JBQUo7QUFDQSxNQUFNLGVBQWUsU0FBUyxjQUFULENBQXdCLGNBQXhCLENBQXJCO0FBQ0EsZUFBYSxTQUFiLEdBQXlCLE1BQXpCO0FBQ0E7QUFDQSxXQUFTLGNBQVQsQ0FBd0IsUUFBeEIsRUFBa0MsZ0JBQWxDLENBQW1ELE9BQW5ELEVBQTRELFlBQU07QUFDaEUsV0FBTyxXQUFQLENBQW1CLEVBQUUsUUFBUSxhQUFWLEVBQW5CO0FBQ0QsR0FGRDtBQUdELENBUkQ7O0FBVUEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmFwaVVSSSA9IFwiaHR0cHM6Ly9mcmVlLmN1cnJlbmN5Y29udmVydGVyYXBpLmNvbS9hcGkvdjVcIjtcbiAgfVxuXG4gIGxvZ0Vycm9yKGVycm9yKSB7XG4gICAgY29uc29sZS5sb2coXCJMb29rcyBsaWtlIHRoZXJlIHdhcyBhIHByb2JsZW06IFxcblwiLCBlcnJvcik7XG4gIH1cblxuICB2YWxpZGF0ZVJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgRXJyb3IocmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG4gICAgfVxuICAgIHJldHVybiByZXNwb25zZTtcbiAgfVxuXG4gIHJlYWRSZXNwb25zZUFzSlNPTihyZXNwb25zZSkge1xuICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gIH1cblxuICBnZXQoZW5kcG9pbnQpIHtcbiAgICBjb25zdCBVUkkgPSBgJHt0aGlzLmFwaVVSSX0ke2VuZHBvaW50fWA7XG4gICAgcmV0dXJuIGZldGNoKFVSSSlcbiAgICAgIC50aGVuKHRoaXMudmFsaWRhdGVSZXNwb25zZSlcbiAgICAgIC50aGVuKHRoaXMucmVhZFJlc3BvbnNlQXNKU09OKVxuICAgICAgLmNhdGNoKHRoaXMubG9nRXJyb3IpO1xuICB9XG59XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoKTtcblxuZXhwb3J0IGRlZmF1bHQgYXBpO1xuIiwiZXhwb3J0IGNsYXNzIENvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc2V0U3RhdGUgPSB0aGlzLnNldFN0YXRlLmJpbmQodGhpcyk7XG4gIH1cblxuICBzZXRTdGF0ZShuZXdTdGF0ZSkge1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHRoaXMuc3RhdGUsIG5ld1N0YXRlKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vLi4vY29tcG9uZW50cy9hcHBcIjtcbmltcG9ydCBhcGkgZnJvbSBcIi4vLi4vYXBpXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbmRleCBleHRlbmRzIENvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGN1cnJlbmNpZXM6IHt9XG4gICAgfTtcbiAgICB0aGlzLmluZGV4REIgPVxuICAgICAgd2luZG93LmluZGV4ZWREQiB8fFxuICAgICAgd2luZG93Lm1vekluZGV4ZWREQiB8fFxuICAgICAgd2luZG93LndlYmtpdEluZGV4ZWREQiB8fFxuICAgICAgd2luZG93Lm1zSW5kZXhlZERCO1xuICAgIHRoaXMuZGJOYW1lID0gXCJDQ29udmVydGVyXCI7XG4gIH1cbiAgLy8gQ3JlYXRlIHRoZSBzY2hlbWFcbiAgb3BlbkRhdGFiYXNlKCkge1xuICAgIC8vIElmIHRoZSBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBzZXJ2aWNlIHdvcmtlcixcbiAgICAvLyB3ZSBkb24ndCBjYXJlIGFib3V0IGhhdmluZyBhIGRhdGFiYXNlXG4gICAgaWYgKCFuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcikge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuaW5kZXhEQikge1xuICAgICAgd2luZG93LmFsZXJ0KFxuICAgICAgICBcIllvdXIgYnJvd3NlciBkb2Vzbid0IHN1cHBvcnQgYSBzdGFibGUgdmVyc2lvbiBvZiBJbmRleGVkREIuIFN1Y2ggYW5kIHN1Y2ggZmVhdHVyZSB3aWxsIG5vdCBiZSBhdmFpbGFibGUuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGRiUHJvbWlzZSA9IHRoaXMuaW5kZXhEQi5vcGVuKHRoaXMuZGJOYW1lLCAyLCB1cGdyYWRlREIgPT4ge1xuICAgICAgaWYgKCF1cGdyYWRlRGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhcImN1cnJlbmN5XCIpKSB7XG4gICAgICAgIHVwZ3JhZGVEYi5jcmVhdGVPYmplY3RTdG9yZShcImN1cnJlbmN5XCIsIHsga2V5UGF0aDogXCJpZFwiIH0pO1xuICAgICAgfVxuICAgICAgaWYgKCF1cGdyYWRlRGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhcImNvdW50cmllc1wiKSkge1xuICAgICAgICB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoXCJjb3VudHJpZXNcIiwgeyBrZXlQYXRoOiBcImlkXCIgfSk7XG4gICAgICB9XG4gICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleChcImN1cnJlbmN5XCIsIFwiY291bnRyaWVzXCIpO1xuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKGRiUHJvbWlzZSk7XG4gICAgZGJQcm9taXNlXG4gICAgICAudGhlbihkYiA9PiB7XG4gICAgICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24odGhpcy5kYk5hbWUsIFwicmVhZHdyaXRlXCIpO1xuICAgICAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKHRoaXMuc3RvcmUpO1xuICAgICAgICBjb25zdCBpdGVtID0ge1xuICAgICAgICAgIGlkOiAxLFxuICAgICAgICAgIG5hbWU6IFwic2FuZHdpY2hzXCIsXG4gICAgICAgICAgcHJpY2U6IDQuOTksXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiQSB2ZXJ5IHRhc3R5IHNhbmR3aWNoXCIsXG4gICAgICAgICAgY3JlYXRlZDogbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICAgICAgfTtcbiAgICAgICAgc3RvcmUuYWRkKHsgLi4uaXRlbSB9KTtcbiAgICAgICAgcmV0dXJuIHR4LmNvbXBsZXRlO1xuICAgICAgfSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJhZGRlZCBpdGVtIHRvIHRoZSBzdG9yZSBvcyFcIik7XG4gICAgICB9KTtcbiAgfVxuXG4gIF9zaG93Q2FjaGVkQ3VycmVuY2llcyA9ICgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhcIltTZXJ2aWNlIFdvcmtlcl0gc2hvd2luZyBjYWNoZWQgaW1hZ2VzXCIpO1xuICAgIHJldHVybiB0aGlzLm9wZW5EYXRhYmFzZSgpO1xuICB9O1xuXG4gIG9uQ2hhbmdlKCkge1xuICAgIGNvbnN0IGN1cnJlbmNpZXMgPSB7IC4uLnRoaXMuc3RhdGUuY3VycmVuY2llcyB9O1xuICAgIHN0b3JlLnB1dChjdXJyZW5jaWVzKTtcbiAgICBjb25zb2xlLmxvZyhjdXJyZW5jaWVzKTtcbiAgfVxuICBwdXRDdXJyZW5jaWVzKCkge1xuICAgIC8vIFN0YXJ0IGEgbmV3IHRyYW5zYWN0aW9uXG4gICAgY29uc3QgZGIgPSB0aGlzLmRiLnJlc3VsdDtcbiAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKHRoaXMuZGJOYW1lLCBcInJlYWR3cml0ZVwiKTtcbiAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKHRoaXMuZGJOYW1lKTtcbiAgICBjb25zdCBpbmRleCA9IHN0b3JlLmluZGV4KFwiY3VycmVuY3lcIik7XG4gICAgY29uc29sZS5sb2coXCJBZGRpbmcgY3VycmVuY2llc1wiKTtcbiAgICAvLyBBZGQgc29tZSBkYXRhXG4gICAgYXBpLmdldChcIi9jdXJyZW5jaWVzXCIpLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgT2JqZWN0LmVudHJpZXMocmVzdWx0LnJlc3VsdHMpLm1hcCh2YWwgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBjdXJyZW5jaWVzOiB7XG4gICAgICAgICAgICAuLi52YWxbMV1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIFF1ZXJ5IHRoZSBkYXRhXG4gICAgLy8gQ2xvc2UgdGhlIGRiIHdoZW4gdGhlIHRyYW5zYWN0aW9uIGlzIGRvbmVcbiAgICB0eC5vbkNvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgZGIuY2xvc2UoKTtcbiAgICB9O1xuICB9XG59XG4iLCJpbXBvcnQgSW5kZXggZnJvbSBcIi4vLi4vaWRiXCI7XG5cbmZ1bmN0aW9uIEluZGV4Q29udHJvbGxlcigpIHtcbiAgY29uc3QgaW5kZXggPSBuZXcgSW5kZXgoKTtcbiAgcmVnaXN0ZXJTZXJ2aWNlV29ya2VyKCk7XG5cbiAgaW5kZXguX3Nob3dDYWNoZWRDdXJyZW5jaWVzKCk7XG59XG5jb25zdCByZWdpc3RlclNlcnZpY2VXb3JrZXIgPSAoKSA9PiB7XG4gIGlmIChcInNlcnZpY2VXb3JrZXJcIiBpbiBuYXZpZ2F0b3IpIHtcbiAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3RlcihcIi4vLi4vc3cuanNcIikudGhlbihyZWcgPT4ge1xuICAgICAgY29uc29sZS5sb2coYFNlcnZpY2UgV29ya2VyIFJlZ2lzdGVyZWQgb24gc2NvcGUgJHtyZWcuc2NvcGV9YCk7XG4gICAgICBpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVnLndhaXRpbmcpIHtcbiAgICAgICAgX3VwZGF0ZVJlYWR5KHJlZy53YWl0aW5nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVnLmluc3RhbGxpbmcpIHtcbiAgICAgICAgX3RyYWNrSW5zdGFsbGluZyhyZWcuaW5zdGFsbGluZyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgcmVnLmFkZEV2ZW50TGlzdGVuZXIoXCJ1cGRhdGVmb3VuZFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgX3RyYWNrSW5zdGFsbGluZyhyZWcuaW5zdGFsbGluZyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGxldCByZWZyZXNoaW5nO1xuICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250cm9sbGVyY2hhbmdlXCIsICgpID0+IHtcbiAgICAgIGlmIChyZWZyZXNoaW5nKSByZXR1cm47XG4gICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICByZWZyZXNoaW5nID0gdHJ1ZTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZyhcIlNlcnZpY2UgV29ya2VyIGlzIG5vdCBzdXBwb3J0ZWQgYnkgYnJvd3Nlci5cIik7XG4gIH1cbn07XG5cbmNvbnN0IF90cmFja0luc3RhbGxpbmcgPSB3b3JrZXIgPT4ge1xuICB3b3JrZXIuYWRkRXZlbnRMaXN0ZW5lcihcInN0YXRlY2hhbmdlXCIsICgpID0+IHtcbiAgICBpZiAod29ya2VyLnN0YXRlID09IFwiaW5zdGFsbGVkXCIpIHtcbiAgICAgIF91cGRhdGVSZWFkeSh3b3JrZXIpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBfdXBkYXRlUmVhZHkgPSB3b3JrZXIgPT4ge1xuICBsZXQgbmV3V29ya2VyO1xuICBjb25zdCBub3RpZmljYXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5vdGlmaWNhdGlvblwiKTtcbiAgbm90aWZpY2F0aW9uLmNsYXNzTmFtZSA9IFwic2hvd1wiO1xuICAvLyBUaGUgY2xpY2sgZXZlbnQgb24gdGhlIHBvcCB1cCBub3RpZmljYXRpb25cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZWxvYWRcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICB3b3JrZXIucG9zdE1lc3NhZ2UoeyBhY3Rpb246IFwic2tpcFdhaXRpbmdcIiB9KTtcbiAgfSk7XG59O1xuXG5JbmRleENvbnRyb2xsZXIoKTtcbiJdfQ==\n"]}
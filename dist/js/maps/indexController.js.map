{"version":3,"sources":["indexController.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","api","Api","instance","TypeError","_classCallCheck","this","apiURI","error","console","log","response","ok","statusText","json","endpoint","URI","fetch","then","validateResponse","readResponseAsJSON","catch","logError","default","2","Component","setState","bind","newState","assign","state","3","obj","_extends","arguments","source","hasOwnProperty","_app","_api","_api2","__esModule","Index","_Component","_this","self","ReferenceError","_possibleConstructorReturn","__proto__","getPrototypeOf","currencies","indexDB","window","indexedDB","mozIndexedDB","webkitIndexedDB","msIndexedDB","DB_NAME","DB_VERSION","DB_STORE_NAME","subClass","superClass","create","constructor","setPrototypeOf","_inherits","_this2","navigator","serviceWorker","Promise","resolve","alert","dbPromise","open","db","store","getObjectStore","dbName","get","entries","result","results","map","val","onChange","onupgradeneeded","event","currentTarget","createObjectStore","keyPath","createIndex","add","tx","complete","store_name","mode","transaction","objectStore","_this3","req","clear","onsuccess","displayActionSuccess","displayCurrList","onerror","errorCode","displayActionFailure","success_callback","blob","openDatabase","./../api","./../components/app","4","_idb","_idb2","_trackInstalling","worker","addEventListener","_updateReady","document","getElementById","className","postMessage","action","register","reg","scope","controller","waiting","installing","refreshing","location","reload","registerServiceWorker","./../idb"],"mappings":"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","file":"../indexController.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Api = function () {\n  function Api() {\n    _classCallCheck(this, Api);\n\n    this.apiURI = \"https://free.currencyconverterapi.com/api/v5\";\n  }\n\n  _createClass(Api, [{\n    key: \"logError\",\n    value: function logError(error) {\n      console.log(\"Looks like there was a problem: \\n\", error);\n    }\n  }, {\n    key: \"validateResponse\",\n    value: function validateResponse(response) {\n      if (!response.ok) {\n        throw Error(response.statusText);\n      }\n      return response;\n    }\n  }, {\n    key: \"readResponseAsJSON\",\n    value: function readResponseAsJSON(response) {\n      return response.json();\n    }\n  }, {\n    key: \"get\",\n    value: function get(endpoint) {\n      var URI = \"\" + this.apiURI + endpoint;\n      return fetch(URI).then(this.validateResponse).then(this.readResponseAsJSON).catch(this.logError);\n    }\n  }]);\n\n  return Api;\n}();\n\nvar api = new Api();\n\nexports.default = api;\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Component = exports.Component = function () {\n  function Component() {\n    _classCallCheck(this, Component);\n\n    this.setState = this.setState.bind(this);\n  }\n\n  _createClass(Component, [{\n    key: \"setState\",\n    value: function setState(newState) {\n      return Object.assign(this.state, newState);\n    }\n  }]);\n\n  return Component;\n}();\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _app = require(\"./../components/app\");\n\nvar _api = require(\"./../api\");\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Index = function (_Component) {\n  _inherits(Index, _Component);\n\n  function Index() {\n    _classCallCheck(this, Index);\n\n    var _this = _possibleConstructorReturn(this, (Index.__proto__ || Object.getPrototypeOf(Index)).call(this));\n\n    _this.state = {\n      currencies: {}\n    };\n    _this.indexDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;\n    _this.DB_NAME = \"CConverter\";\n    _this.DB_VERSION = 1;\n    _this.DB_STORE_NAME = \"CConverter\";\n    return _this;\n  }\n  // Create the schema\n\n\n  _createClass(Index, [{\n    key: \"openDatabase\",\n    value: function openDatabase() {\n      var _this2 = this;\n\n      // If the browser doesn't support service worker,\n      // we don't care about having a database\n      var db = void 0;\n      console.log(\"openDatabase\");\n      if (!navigator.serviceWorker) {\n        return Promise.resolve();\n      }\n      if (!this.indexDB) {\n        window.alert(\"Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.\");\n      }\n      var dbPromise = this.indexDB.open(this.DB_NAME, this.DB_VERSION);\n\n      console.log(dbPromise);\n      dbPromise.then(function (db) {\n        var store = getObjectStore(_this2.dbName, \"readwrite\");\n\n        // Add some data\n        _api2.default.get(\"/currencies\").then(function (response) {\n          Object.entries(result.results).map(function (val) {\n            _this2.setState({\n              currencies: _extends({}, val[1])\n            });\n            _this2.onChange(store);\n          });\n        });\n      }).then(function () {\n        console.log(\"added item to the store os!\");\n      });\n\n      dbPromise.onupgradeneeded(function (event) {\n        console.log(\"dbPromise.onupgradeneeded\");\n        var store = event.currentTarget.result.createObjectStore(_this2.DB_STORE_NAME, {\n          keyPath: \"id\"\n        });\n        store.createIndex(\"currency\", \"countries\");\n      });\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(store) {\n      var currencies = _extends({}, this.state.currencies);\n      store.add(currencies);\n\n      return tx.complete;\n      console.log(currencies);\n    }\n    /**\n     * @param {string} store_name\n     * @param {string} mode either \"readonly\" or \"readwrite\"\n     */\n\n  }, {\n    key: \"getObjectStore\",\n    value: function getObjectStore(store_name, mode) {\n      var tx = db.transaction(store_name, mode);\n      return tx.objectStore(store_name);\n    }\n  }, {\n    key: \"clearObjectStore\",\n    value: function clearObjectStore(store_name) {\n      var _this3 = this;\n\n      var store = getObjectStore(this.DB_STORE_NAME, \"readwrite\");\n      var req = store.clear();\n      req.onsuccess = function (event) {\n        displayActionSuccess(\"Store cleared\");\n        displayCurrList(store);\n      };\n      req.onerror = function (event) {\n        console.error(\"clearObjectStore:\", event.target.errorCode);\n        displayActionFailure(_this3.error);\n      };\n    }\n  }, {\n    key: \"getBlob\",\n    value: function getBlob(key, store, success_callback) {\n      var req = store.get(key);\n      req.onsuccess = function (event) {\n        var value = event.target.result;\n        if (value) success_callback(value.blob);\n      };\n    }\n\n    /**\n     * @param {IDBObjectStore=} store\n     */\n\n  }, {\n    key: \"_showCachedCurrencies\",\n    value: function _showCachedCurrencies() {\n      console.log(\"[Service Worker] showing cached images\");\n      return this.openDatabase();\n    }\n  }]);\n\n  return Index;\n}(_app.Component);\n\nexports.default = Index;\n\n},{\"./../api\":1,\"./../components/app\":2}],4:[function(require,module,exports){\n\"use strict\";\n\nvar _idb = require(\"./../idb\");\n\nvar _idb2 = _interopRequireDefault(_idb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction IndexController() {\n  var index = new _idb2.default();\n\n  index.openDatabase();\n}\nvar registerServiceWorker = function registerServiceWorker() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.register(\"./../sw.js\").then(function (reg) {\n      console.log(\"Service Worker Registered on scope \" + reg.scope);\n      if (!navigator.serviceWorker.controller) {\n        return;\n      }\n\n      if (reg.waiting) {\n        _updateReady(reg.waiting);\n        return;\n      }\n\n      if (reg.installing) {\n        _trackInstalling(reg.installing);\n        return;\n      }\n\n      reg.addEventListener(\"updatefound\", function () {\n        _trackInstalling(reg.installing);\n      });\n    });\n\n    var refreshing = void 0;\n    navigator.serviceWorker.addEventListener(\"controllerchange\", function () {\n      if (refreshing) return;\n      window.location.reload();\n      refreshing = true;\n    });\n  } else {\n    console.log(\"Service Worker is not supported by browser.\");\n  }\n};\n\nvar _trackInstalling = function _trackInstalling(worker) {\n  worker.addEventListener(\"statechange\", function () {\n    if (worker.state == \"installed\") {\n      _updateReady(worker);\n    }\n  });\n};\n\nvar _updateReady = function _updateReady(worker) {\n  var newWorker = void 0;\n  var notification = document.getElementById(\"notification\");\n  notification.className = \"show\";\n  // The click event on the pop up notification\n  document.getElementById(\"reload\").addEventListener(\"click\", function () {\n    worker.postMessage({ action: \"skipWaiting\" });\n  });\n};\nregisterServiceWorker();\nIndexController();\n\n},{\"./../idb\":3}]},{},[4])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvYXBpL2luZGV4LmpzIiwic3JjL2pzL2NvbXBvbmVudHMvYXBwLmpzIiwic3JjL2pzL2lkYi9pbmRleC5qcyIsInNyYy9qcy9tYWluL2luZGV4Q29udHJvbGxlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7SUNBTSxHO0FBQ0osaUJBQWM7QUFBQTs7QUFDWixTQUFLLE1BQUwsR0FBYyw4Q0FBZDtBQUNEOzs7OzZCQUVRLEssRUFBTztBQUNkLGNBQVEsR0FBUixDQUFZLG9DQUFaLEVBQWtELEtBQWxEO0FBQ0Q7OztxQ0FFZ0IsUSxFQUFVO0FBQ3pCLFVBQUksQ0FBQyxTQUFTLEVBQWQsRUFBa0I7QUFDaEIsY0FBTSxNQUFNLFNBQVMsVUFBZixDQUFOO0FBQ0Q7QUFDRCxhQUFPLFFBQVA7QUFDRDs7O3VDQUVrQixRLEVBQVU7QUFDM0IsYUFBTyxTQUFTLElBQVQsRUFBUDtBQUNEOzs7d0JBRUcsUSxFQUFVO0FBQ1osVUFBTSxXQUFTLEtBQUssTUFBZCxHQUF1QixRQUE3QjtBQUNBLGFBQU8sTUFBTSxHQUFOLEVBQ0osSUFESSxDQUNDLEtBQUssZ0JBRE4sRUFFSixJQUZJLENBRUMsS0FBSyxrQkFGTixFQUdKLEtBSEksQ0FHRSxLQUFLLFFBSFAsQ0FBUDtBQUlEOzs7Ozs7QUFHSCxJQUFNLE1BQU0sSUFBSSxHQUFKLEVBQVo7O2tCQUVlLEc7Ozs7Ozs7Ozs7Ozs7SUMvQkYsUyxXQUFBLFM7QUFDWCx1QkFBYztBQUFBOztBQUNaLFNBQUssUUFBTCxHQUFnQixLQUFLLFFBQUwsQ0FBYyxJQUFkLENBQW1CLElBQW5CLENBQWhCO0FBQ0Q7Ozs7NkJBRVEsUSxFQUFVO0FBQ2pCLGFBQU8sT0FBTyxNQUFQLENBQWMsS0FBSyxLQUFuQixFQUEwQixRQUExQixDQUFQO0FBQ0Q7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDUEg7O0FBQ0E7Ozs7Ozs7Ozs7OztJQUNx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QUNqQyxTQUFPLGdCQUFQLENBQXdCLGFBQXhCLEVBQXVDLFlBQU07QUFDM0MsUUFBSSxPQUFPLEtBQVAsSUFBZ0IsV0FBcEIsRUFBaUM7QUFDL0IsbUJBQWEsTUFBYjtBQUNEO0FBQ0YsR0FKRDtBQUtELENBTkQ7O0FBUUEsSUFBTSxlQUFlLFNBQWYsWUFBZSxTQUFVO0FBQzdCLE1BQUksa0JBQUo7QUFDQSxNQUFNLGVBQWUsU0FBUyxjQUFULENBQXdCLGNBQXhCLENBQXJCO0FBQ0EsZUFBYSxTQUFiLEdBQXlCLE1BQXpCO0FBQ0E7QUFDQSxXQUFTLGNBQVQsQ0FBd0IsUUFBeEIsRUFBa0MsZ0JBQWxDLENBQW1ELE9BQW5ELEVBQTRELFlBQU07QUFDaEUsV0FBTyxXQUFQLENBQW1CLEVBQUUsUUFBUSxhQUFWLEVBQW5CO0FBQ0QsR0FGRDtBQUdELENBUkQ7QUFTQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5hcGlVUkkgPSBcImh0dHBzOi8vZnJlZS5jdXJyZW5jeWNvbnZlcnRlcmFwaS5jb20vYXBpL3Y1XCI7XG4gIH1cblxuICBsb2dFcnJvcihlcnJvcikge1xuICAgIGNvbnNvbGUubG9nKFwiTG9va3MgbGlrZSB0aGVyZSB3YXMgYSBwcm9ibGVtOiBcXG5cIiwgZXJyb3IpO1xuICB9XG5cbiAgdmFsaWRhdGVSZXNwb25zZShyZXNwb25zZSkge1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IEVycm9yKHJlc3BvbnNlLnN0YXR1c1RleHQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cblxuICByZWFkUmVzcG9uc2VBc0pTT04ocmVzcG9uc2UpIHtcbiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICB9XG5cbiAgZ2V0KGVuZHBvaW50KSB7XG4gICAgY29uc3QgVVJJID0gYCR7dGhpcy5hcGlVUkl9JHtlbmRwb2ludH1gO1xuICAgIHJldHVybiBmZXRjaChVUkkpXG4gICAgICAudGhlbih0aGlzLnZhbGlkYXRlUmVzcG9uc2UpXG4gICAgICAudGhlbih0aGlzLnJlYWRSZXNwb25zZUFzSlNPTilcbiAgICAgIC5jYXRjaCh0aGlzLmxvZ0Vycm9yKTtcbiAgfVxufVxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGFwaTtcbiIsImV4cG9ydCBjbGFzcyBDb21wb25lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnNldFN0YXRlID0gdGhpcy5zZXRTdGF0ZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgc2V0U3RhdGUobmV3U3RhdGUpIHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih0aGlzLnN0YXRlLCBuZXdTdGF0ZSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuLy4uL2NvbXBvbmVudHMvYXBwXCI7XG5pbXBvcnQgYXBpIGZyb20gXCIuLy4uL2FwaVwiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5kZXggZXh0ZW5kcyBDb21wb25lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBjdXJyZW5jaWVzOiB7fVxuICAgIH07XG4gICAgdGhpcy5pbmRleERCID1cbiAgICAgIHdpbmRvdy5pbmRleGVkREIgfHxcbiAgICAgIHdpbmRvdy5tb3pJbmRleGVkREIgfHxcbiAgICAgIHdpbmRvdy53ZWJraXRJbmRleGVkREIgfHxcbiAgICAgIHdpbmRvdy5tc0luZGV4ZWREQjtcbiAgICB0aGlzLkRCX05BTUUgPSBcIkNDb252ZXJ0ZXJcIjtcbiAgICB0aGlzLkRCX1ZFUlNJT04gPSAxO1xuICAgIHRoaXMuREJfU1RPUkVfTkFNRSA9IFwiQ0NvbnZlcnRlclwiO1xuICB9XG4gIC8vIENyZWF0ZSB0aGUgc2NoZW1hXG4gIG9wZW5EYXRhYmFzZSgpIHtcbiAgICAvLyBJZiB0aGUgYnJvd3NlciBkb2Vzbid0IHN1cHBvcnQgc2VydmljZSB3b3JrZXIsXG4gICAgLy8gd2UgZG9uJ3QgY2FyZSBhYm91dCBoYXZpbmcgYSBkYXRhYmFzZVxuICAgIGxldCBkYjtcbiAgICBjb25zb2xlLmxvZyhcIm9wZW5EYXRhYmFzZVwiKTtcbiAgICBpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGlmICghdGhpcy5pbmRleERCKSB7XG4gICAgICB3aW5kb3cuYWxlcnQoXG4gICAgICAgIFwiWW91ciBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBhIHN0YWJsZSB2ZXJzaW9uIG9mIEluZGV4ZWREQi4gU3VjaCBhbmQgc3VjaCBmZWF0dXJlIHdpbGwgbm90IGJlIGF2YWlsYWJsZS5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgZGJQcm9taXNlID0gdGhpcy5pbmRleERCLm9wZW4odGhpcy5EQl9OQU1FLCB0aGlzLkRCX1ZFUlNJT04pO1xuXG4gICAgY29uc29sZS5sb2coZGJQcm9taXNlKTtcbiAgICBkYlByb21pc2VcbiAgICAgIC50aGVuKGRiID0+IHtcbiAgICAgICAgY29uc3Qgc3RvcmUgPSBnZXRPYmplY3RTdG9yZSh0aGlzLmRiTmFtZSwgXCJyZWFkd3JpdGVcIik7XG5cbiAgICAgICAgLy8gQWRkIHNvbWUgZGF0YVxuICAgICAgICBhcGkuZ2V0KFwiL2N1cnJlbmNpZXNcIikudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgT2JqZWN0LmVudHJpZXMocmVzdWx0LnJlc3VsdHMpLm1hcCh2YWwgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgIGN1cnJlbmNpZXM6IHtcbiAgICAgICAgICAgICAgICAuLi52YWxbMV1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKHN0b3JlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcImFkZGVkIGl0ZW0gdG8gdGhlIHN0b3JlIG9zIVwiKTtcbiAgICAgIH0pO1xuXG4gICAgZGJQcm9taXNlLm9udXBncmFkZW5lZWRlZChldmVudCA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcImRiUHJvbWlzZS5vbnVwZ3JhZGVuZWVkZWRcIik7XG4gICAgICBjb25zdCBzdG9yZSA9IGV2ZW50LmN1cnJlbnRUYXJnZXQucmVzdWx0LmNyZWF0ZU9iamVjdFN0b3JlKFxuICAgICAgICB0aGlzLkRCX1NUT1JFX05BTUUsXG4gICAgICAgIHtcbiAgICAgICAgICBrZXlQYXRoOiBcImlkXCJcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHN0b3JlLmNyZWF0ZUluZGV4KFwiY3VycmVuY3lcIiwgXCJjb3VudHJpZXNcIik7XG4gICAgfSk7XG4gIH1cblxuICBvbkNoYW5nZShzdG9yZSkge1xuICAgIGNvbnN0IGN1cnJlbmNpZXMgPSB7IC4uLnRoaXMuc3RhdGUuY3VycmVuY2llcyB9O1xuICAgIHN0b3JlLmFkZChjdXJyZW5jaWVzKTtcblxuICAgIHJldHVybiB0eC5jb21wbGV0ZTtcbiAgICBjb25zb2xlLmxvZyhjdXJyZW5jaWVzKTtcbiAgfVxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHN0b3JlX25hbWVcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1vZGUgZWl0aGVyIFwicmVhZG9ubHlcIiBvciBcInJlYWR3cml0ZVwiXG4gICAqL1xuICBnZXRPYmplY3RTdG9yZShzdG9yZV9uYW1lLCBtb2RlKSB7XG4gICAgdmFyIHR4ID0gZGIudHJhbnNhY3Rpb24oc3RvcmVfbmFtZSwgbW9kZSk7XG4gICAgcmV0dXJuIHR4Lm9iamVjdFN0b3JlKHN0b3JlX25hbWUpO1xuICB9XG5cbiAgY2xlYXJPYmplY3RTdG9yZShzdG9yZV9uYW1lKSB7XG4gICAgY29uc3Qgc3RvcmUgPSBnZXRPYmplY3RTdG9yZSh0aGlzLkRCX1NUT1JFX05BTUUsIFwicmVhZHdyaXRlXCIpO1xuICAgIGNvbnN0IHJlcSA9IHN0b3JlLmNsZWFyKCk7XG4gICAgcmVxLm9uc3VjY2VzcyA9IGV2ZW50ID0+IHtcbiAgICAgIGRpc3BsYXlBY3Rpb25TdWNjZXNzKFwiU3RvcmUgY2xlYXJlZFwiKTtcbiAgICAgIGRpc3BsYXlDdXJyTGlzdChzdG9yZSk7XG4gICAgfTtcbiAgICByZXEub25lcnJvciA9IGV2ZW50ID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJjbGVhck9iamVjdFN0b3JlOlwiLCBldmVudC50YXJnZXQuZXJyb3JDb2RlKTtcbiAgICAgIGRpc3BsYXlBY3Rpb25GYWlsdXJlKHRoaXMuZXJyb3IpO1xuICAgIH07XG4gIH1cblxuICBnZXRCbG9iKGtleSwgc3RvcmUsIHN1Y2Nlc3NfY2FsbGJhY2spIHtcbiAgICBjb25zdCByZXEgPSBzdG9yZS5nZXQoa2V5KTtcbiAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgIGlmICh2YWx1ZSkgc3VjY2Vzc19jYWxsYmFjayh2YWx1ZS5ibG9iKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7SURCT2JqZWN0U3RvcmU9fSBzdG9yZVxuICAgKi9cblxuICBfc2hvd0NhY2hlZEN1cnJlbmNpZXMoKSB7XG4gICAgY29uc29sZS5sb2coXCJbU2VydmljZSBXb3JrZXJdIHNob3dpbmcgY2FjaGVkIGltYWdlc1wiKTtcbiAgICByZXR1cm4gdGhpcy5vcGVuRGF0YWJhc2UoKTtcbiAgfVxufVxuIiwiaW1wb3J0IEluZGV4IGZyb20gXCIuLy4uL2lkYlwiO1xuXG5mdW5jdGlvbiBJbmRleENvbnRyb2xsZXIoKSB7XG4gIGNvbnN0IGluZGV4ID0gbmV3IEluZGV4KCk7XG5cbiAgaW5kZXgub3BlbkRhdGFiYXNlKCk7XG59XG5jb25zdCByZWdpc3RlclNlcnZpY2VXb3JrZXIgPSAoKSA9PiB7XG4gIGlmIChcInNlcnZpY2VXb3JrZXJcIiBpbiBuYXZpZ2F0b3IpIHtcbiAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3RlcihcIi4vLi4vc3cuanNcIikudGhlbihyZWcgPT4ge1xuICAgICAgY29uc29sZS5sb2coYFNlcnZpY2UgV29ya2VyIFJlZ2lzdGVyZWQgb24gc2NvcGUgJHtyZWcuc2NvcGV9YCk7XG4gICAgICBpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVnLndhaXRpbmcpIHtcbiAgICAgICAgX3VwZGF0ZVJlYWR5KHJlZy53YWl0aW5nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVnLmluc3RhbGxpbmcpIHtcbiAgICAgICAgX3RyYWNrSW5zdGFsbGluZyhyZWcuaW5zdGFsbGluZyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgcmVnLmFkZEV2ZW50TGlzdGVuZXIoXCJ1cGRhdGVmb3VuZFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgX3RyYWNrSW5zdGFsbGluZyhyZWcuaW5zdGFsbGluZyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGxldCByZWZyZXNoaW5nO1xuICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250cm9sbGVyY2hhbmdlXCIsICgpID0+IHtcbiAgICAgIGlmIChyZWZyZXNoaW5nKSByZXR1cm47XG4gICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICByZWZyZXNoaW5nID0gdHJ1ZTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZyhcIlNlcnZpY2UgV29ya2VyIGlzIG5vdCBzdXBwb3J0ZWQgYnkgYnJvd3Nlci5cIik7XG4gIH1cbn07XG5cbmNvbnN0IF90cmFja0luc3RhbGxpbmcgPSB3b3JrZXIgPT4ge1xuICB3b3JrZXIuYWRkRXZlbnRMaXN0ZW5lcihcInN0YXRlY2hhbmdlXCIsICgpID0+IHtcbiAgICBpZiAod29ya2VyLnN0YXRlID09IFwiaW5zdGFsbGVkXCIpIHtcbiAgICAgIF91cGRhdGVSZWFkeSh3b3JrZXIpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBfdXBkYXRlUmVhZHkgPSB3b3JrZXIgPT4ge1xuICBsZXQgbmV3V29ya2VyO1xuICBjb25zdCBub3RpZmljYXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5vdGlmaWNhdGlvblwiKTtcbiAgbm90aWZpY2F0aW9uLmNsYXNzTmFtZSA9IFwic2hvd1wiO1xuICAvLyBUaGUgY2xpY2sgZXZlbnQgb24gdGhlIHBvcCB1cCBub3RpZmljYXRpb25cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZWxvYWRcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICB3b3JrZXIucG9zdE1lc3NhZ2UoeyBhY3Rpb246IFwic2tpcFdhaXRpbmdcIiB9KTtcbiAgfSk7XG59O1xucmVnaXN0ZXJTZXJ2aWNlV29ya2VyKCk7XG5JbmRleENvbnRyb2xsZXIoKTtcbiJdfQ==\n"]}